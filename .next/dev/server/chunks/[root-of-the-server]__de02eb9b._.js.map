{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/hemilpatel/Documents/dev/codex/aeogeoproj/lib/persistence/memoryStore.ts"],"sourcesContent":["import { Analysis, AnalysisContext, AnalysisRecord, AnalysisStatus } from \"../analysis/types\";\n\ntype StoreState = {\n  records: Map<string, AnalysisRecord>;\n};\n\nconst globalStore: StoreState =\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  (globalThis as any).__analysisMemoryStore ??\n  {\n    records: new Map<string, AnalysisRecord>(),\n  };\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\n(globalThis as any).__analysisMemoryStore = globalStore;\n\nexport class InMemoryAnalysisStore {\n  createRecord(id: string, topic: string, context: AnalysisContext, status: AnalysisStatus): AnalysisRecord {\n    const now = new Date().toISOString();\n    const record: AnalysisRecord = {\n      id,\n      status,\n      created_at: now,\n      updated_at: now,\n      request: {\n        topic,\n        context,\n      },\n    };\n    globalStore.records.set(id, record);\n    return record;\n  }\n\n  saveAnalysis(id: string, analysis: Analysis, status: AnalysisStatus = \"complete\"): AnalysisRecord | undefined {\n    const record = globalStore.records.get(id);\n    if (!record) return undefined;\n    const updated: AnalysisRecord = {\n      ...record,\n      analysis,\n      status,\n      updated_at: new Date().toISOString(),\n    };\n    globalStore.records.set(id, updated);\n    return updated;\n  }\n\n  markFailed(id: string, error: string): AnalysisRecord | undefined {\n    const record = globalStore.records.get(id);\n    if (!record) return undefined;\n    const updated: AnalysisRecord = {\n      ...record,\n      status: \"failed\",\n      error,\n      updated_at: new Date().toISOString(),\n    };\n    globalStore.records.set(id, updated);\n    return updated;\n  }\n\n  getRecord(id: string): AnalysisRecord | undefined {\n    return globalStore.records.get(id);\n  }\n}\n\nexport const analysisStore = new InMemoryAnalysisStore();\n"],"names":[],"mappings":";;;;;;AAMA,MAAM,cACJ,8DAA8D;AAC7D,WAAmB,qBAAqB,IACzC;IACE,SAAS,IAAI;AACf;AAEF,8DAA8D;AAC7D,WAAmB,qBAAqB,GAAG;AAErC,MAAM;IACX,aAAa,EAAU,EAAE,KAAa,EAAE,OAAwB,EAAE,MAAsB,EAAkB;QACxG,MAAM,MAAM,IAAI,OAAO,WAAW;QAClC,MAAM,SAAyB;YAC7B;YACA;YACA,YAAY;YACZ,YAAY;YACZ,SAAS;gBACP;gBACA;YACF;QACF;QACA,YAAY,OAAO,CAAC,GAAG,CAAC,IAAI;QAC5B,OAAO;IACT;IAEA,aAAa,EAAU,EAAE,QAAkB,EAAE,SAAyB,UAAU,EAA8B;QAC5G,MAAM,SAAS,YAAY,OAAO,CAAC,GAAG,CAAC;QACvC,IAAI,CAAC,QAAQ,OAAO;QACpB,MAAM,UAA0B;YAC9B,GAAG,MAAM;YACT;YACA;YACA,YAAY,IAAI,OAAO,WAAW;QACpC;QACA,YAAY,OAAO,CAAC,GAAG,CAAC,IAAI;QAC5B,OAAO;IACT;IAEA,WAAW,EAAU,EAAE,KAAa,EAA8B;QAChE,MAAM,SAAS,YAAY,OAAO,CAAC,GAAG,CAAC;QACvC,IAAI,CAAC,QAAQ,OAAO;QACpB,MAAM,UAA0B;YAC9B,GAAG,MAAM;YACT,QAAQ;YACR;YACA,YAAY,IAAI,OAAO,WAAW;QACpC;QACA,YAAY,OAAO,CAAC,GAAG,CAAC,IAAI;QAC5B,OAAO;IACT;IAEA,UAAU,EAAU,EAA8B;QAChD,OAAO,YAAY,OAAO,CAAC,GAAG,CAAC;IACjC;AACF;AAEO,MAAM,gBAAgB,IAAI"}},
    {"offset": {"line": 107, "column": 0}, "map": {"version":3,"sources":["file:///Users/hemilpatel/Documents/dev/codex/aeogeoproj/app/api/analyses/%5Banalysis_id%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { analysisStore } from \"@/lib/persistence/memoryStore\";\n\ntype Params = {\n  params: {\n    analysis_id: string;\n  };\n};\n\nexport async function GET(_request: NextRequest, { params }: Params) {\n  const { analysis_id } = params;\n  const record = analysisStore.getRecord(analysis_id);\n\n  if (!record) {\n    return NextResponse.json({ error: \"Analysis not found\" }, { status: 404 });\n  }\n\n  return NextResponse.json({\n    analysis_id: record.id,\n    status: record.status,\n    analysis: record.status === \"complete\" ? record.analysis : undefined,\n    error: record.status === \"failed\" ? record.error ?? \"Analysis failed\" : undefined,\n  });\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAQO,eAAe,IAAI,QAAqB,EAAE,EAAE,MAAM,EAAU;IACjE,MAAM,EAAE,WAAW,EAAE,GAAG;IACxB,MAAM,SAAS,oJAAa,CAAC,SAAS,CAAC;IAEvC,IAAI,CAAC,QAAQ;QACX,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAqB,GAAG;YAAE,QAAQ;QAAI;IAC1E;IAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;QACvB,aAAa,OAAO,EAAE;QACtB,QAAQ,OAAO,MAAM;QACrB,UAAU,OAAO,MAAM,KAAK,aAAa,OAAO,QAAQ,GAAG;QAC3D,OAAO,OAAO,MAAM,KAAK,WAAW,OAAO,KAAK,IAAI,oBAAoB;IAC1E;AACF"}}]
}